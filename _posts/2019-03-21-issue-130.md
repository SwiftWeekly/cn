---
layout: post
title: ! 'Issue #130'
author: btb
---

ä¸Šä¸ªæ˜ŸæœŸï¼ŒApple å…¬å¸ƒäº†ä»Šå¹´ WWDC çš„æ—¥æœŸï¼Œè€Œ Swift å¼€å‘ç¤¾åŒºæ­£æœ‰åºåœ°æ¨è¿›ç»§ Swift 5 åçš„å¼€å‘å·¥ä½œã€‚

<!--excerpt-->

### å…¥é—¨ä»»åŠ¡

- [TF-336](https://bugs.swift.org/browse/TF-336) [Python] Add unit testing infrastructure for Python 2 and 3
- [TF-337](https://bugs.swift.org/browse/TF-337) [Python] `PythonObject` conformance to `Sequence` uses array indexing instead of `Python.iter(...)`
- [TF-342](https://bugs.swift.org/browse/TF-342) [Python] Adopt Python iterator C API
- [TF-351](https://bugs.swift.org/browse/TF-351) [AutoDiff] Fixit `.withoutDerivative()` is inserted to the wrong place

### ç¤¾åŒºæ–°é—»

[Chris Lattner](https://twitter.com/clattner_llvm) å’Œ [Brennan Saeta](https://twitter.com/bsaeta) åœ¨ TensorFlow Dev Summit 2019 å…³äº Swift for TensorFlow çš„[æ¼”è®²è§†é¢‘](https://www.youtube.com/watch?v=s65BigoMV_I)ã€‚

SwiftNIO 2 å‘å¸ƒä¸´è¿‘ï¼Œå®˜æ–¹å…¬å¼€äº†[ç›¸å…³çš„èåˆè®¡åˆ’](https://forums.swift.org/t/swiftnio-2-repository-convergence-plan/21387)ã€‚SwiftNIO 2 åŒ…æ‹¬æ”¹å–„äº†å¾ˆå¤š[å…¬ç”¨ API](https://github.com/apple/swift-nio/blob/master/docs/public-api.md)ï¼Œä»¥åŠè¿™é‡Œæœ‰ä¸€ä»½å¾ˆæœ‰ç”¨çš„[è¿ç§»æŒ‡å—](https://github.com/apple/swift-nio/blob/master/docs/migration-guide-NIO1-to-NIO2.md)ã€‚ ğŸš€

Johannes Weiss [æ­£å¼å®£å¸ƒ](https://forums.swift.org/t/swift-log-is-open/21750) `swift-log` ä»“åº“[å¼€æº](https://github.com/apple/swift-log)ã€‚

> [..] `swift-log` åªæ˜¯å¼€æºæ•´ä¸ªç”Ÿæ€ç³»ç»Ÿçš„åºå¹•ã€‚

### åˆå¹¶è¯·æ±‚

[John Holdsworth](https://twitter.com/Injection4Xcode) 
åˆå¹¶äº†[ä¸€ä¸ª pull request](https://github.com/apple/swift/pull/22863)
ç”¨äºå®ç°ä¸€ä¸ªä¸‰å¹´å‰çš„ææ¡ˆ [SE-0068](https://github.com/apple/swift-evolution/blob/master/proposals/0068-universal-self.md): *Expanding Swift `Self` to class members and value types*! ğŸ’ª

[Eric Eckstein](https://github.com/eeckstein) åˆå¹¶äº†[ä¸€ä¸ª pull request](https://github.com/apple/swift/pull/23249)ï¼Œä¸»è¦ä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼Œå¹¶æŸç§ç¨‹åº¦ä¸ŠåŠ å¿« runtime çš„é€Ÿåº¦ã€‚

### æ–°æ™‹ææ¡ˆ

[SE-0242](https://github.com/apple/swift-evolution/blob/master/proposals/0242-default-values-memberwise.md): *Synthesize default values for the memberwise initializer* [è¢«æ¥å—](https://forums.swift.org/t/accepted-se-0242-synthesize-default-values-for-the-memberwise-initializer/21475)ã€‚

> è¯¥ææ¡ˆè¢«æ¥å—ï¼Œå¹¶è¦æ±‚ä¿®æ”¹åŸå§‹ææ¡ˆä»¥è¯´æ˜å®é™…çš„è¡Œä¸ºã€‚æ ¸å¿ƒå›¢é˜Ÿè®¤ä¸ºè¯¥ææ¡ˆåº”è¯¥æ›´æ˜ç¡®åœ°æè¿°ç‰¹å®šæƒ…å†µä¸‹çš„è¡Œä¸ºï¼Œå› ä¸ºè¿™æ˜¯å®¡æ ¸æµç¨‹å…³æ³¨æ¯”è¾ƒå¤šçš„åœ°æ–¹ã€‚æ³¨æ„ï¼šè¯¥ææ¡ˆå·²ç»æ›´æ–°ï¼Œåœ¨ [_proposed solution_ ç« èŠ‚](https://github.com/apple/swift-evolution/blob/b5bbc5ae1f53189641951acfd50870f5b886859e/proposals/0242-default-values-memberwise.md#proposed-solution)ä¸­åŒ…å«æ›´å¤šè¯¦æƒ…ã€‚

### é€€å›ææ¡ˆ

[SE-0245](https://github.com/apple/swift-evolution/blob/master/proposals/0245-array-uninitialized-initializer.md): *Add an Array Initializer with Access to Uninitialized Storage* [è¢«é€€å›ä¿®æ”¹](https://forums.swift.org/t/se-0245-add-an-array-initializer-with-access-to-uninitialized-storage/21469)ï¼Œä»¥ä½œä¸º [SE-0223](https://github.com/apple/swift-evolution/blob/master/proposals/0223-array-uninitialized-initializer.md) çš„ä¸€éƒ¨åˆ†ã€‚

### å®¡æ ¸ä¸­ææ¡ˆ

[SE-0250](https://github.com/apple/swift-evolution/blob/master/proposals/0250-swift-style-guide-and-formatter.md): *Swift Code Style Guidelines and Formatter* [æ­£åœ¨å®¡æ ¸ä¸­](https://forums.swift.org/t/se-0250-swift-code-style-guidelines-and-formatter/21795)ã€‚

[SE-0249](https://github.com/apple/swift-evolution/blob/master/proposals/0249-key-path-literal-function-expressions.md): *Key Path Expressions as Functions* [æ­£åœ¨å®¡æ ¸ä¸­](https://forums.swift.org/t/se-0249-key-path-expressions-as-functions/21780)ã€‚

[SE-0248](https://github.com/apple/swift-evolution/blob/master/proposals/0248-string-gaps-missing-apis.md): *String Gaps and Missing APIs* [æ­£åœ¨å®¡æ ¸ä¸­](https://github.com/apple/swift-evolution/blob/master/proposals/0248-string-gaps-missing-apis.md)ã€‚

> å­—ç¬¦ä¸²åŠç›¸å…³çš„ç±»å‹ç¼ºå°‘æŸäº›ç®€æ˜æ˜“ç”¨çš„å‡½æ•°/å±æ€§ï¼Œè€Œè¿™äº›ç®€æ˜æ˜“ç”¨çš„å‡½æ•°/å±æ€§å½“å‰å·²ç»åœ¨å†…éƒ¨å®ç°ä¸­ä»¥æŸç§å½¢å¼å®ç°äº†ï¼Œä½†å°šæœªå…¬å¼€ä¸º APIã€‚æˆ‘ä»¬å»ºè®®æ·»åŠ  9 ä¸ªæ–°æ–¹æ³•/å±æ€§å’Œ 3 ä¸ªæ–°ä»£ç å•å…ƒè§†å›¾ã€‚
>
> è¿™äº›ç¼ºå¤±çš„ API è§£å†³äº† String ç”¨æˆ·åŠå…¶å„ç§ç±»å‹çš„ç”¨æˆ·[å¸¸é‡åˆ°](https://forums.swift.org/t/efficiently-retrieving-utf8-from-a-character-in-a-string/19916)çš„æ¼æ´å’Œ[ç¼ºå¤±çš„åŠŸèƒ½](https://bugs.swift.org/browse/SR-9955)ï¼Œé€šå¸¸ä¼šå¯¼è‡´å¼€å‘äººå‘˜[é‡é€ ç›¸åŒçš„è½®å­](https://github.com/apple/swift-nio-http2/blob/master/Sources/NIOHPACK/HPACKHeader.swift#L412)ã€‚
>
> å› æ­¤æˆ‘ä»¬å»ºè®®ï¼š
>
> * ä¸º Unicode ä¸åŒçš„ç¼–ç æ–°å¢ 6 ä¸ªç®€å•çš„ API
> * ä¸ºå­—ç¬¦ä¸²ç´¢å¼•å’ŒèŒƒå›´ç´¢å¼•æ–°å¢ 2 ä¸ªèŒƒå‹åˆå§‹åŒ–æ–¹æ³•
> * `Substring.base` åº”ç­‰åŒäº `Slice.base`
> * å°† `Character.UTF8View` å’Œ `Character.UTF16View` å…¬å¼€
> * æ–°å¢ `Unicode.Scalar.UTF8View`

[SE-0247](https://github.com/apple/swift-evolution/blob/master/proposals/0247-contiguous-strings.md): *Contiguous Strings* [æ­£åœ¨å®¡æ ¸ä¸­](https://forums.swift.org/t/se-0247-contiguous-strings/21483)ã€‚

[SE-0246](https://github.com/apple/swift-evolution/blob/master/proposals/0246-mathable.md): *Generic Math(s) Functions* [æ­£åœ¨å®¡æ ¸ä¸­](https://forums.swift.org/t/se-0246-generic-math-s-functions/21479)ã€‚

> è¯¥ææ¡ˆä¸ºæ ‡å‡†åº“å¼•å…¥äº†ä¸¤ä¸ªæ–°åè®®ï¼š`ElementaryFunctions` å’Œ `Real`ã€‚è¿™äº›åè®®ç»„åˆåœ¨é€šç”¨ä¸Šä¸‹æ–‡ä¸­ä¸ºæµ®ç‚¹å’Œ SIMD ç±»å‹æä¾›**åŸºæœ¬æ•°å­¦å‡½æ•°**ã€‚ 
>
> BinaryFloatingPointï¼ˆä»¥åŠå®ƒæç‚¼çš„åè®®ï¼‰ä¸ºç¼–å†™æ•°å­—ä»£ç æä¾›äº†ä¸€ç»„å¼ºå¤§çš„æŠ½è±¡æ–¹æ³•ï¼Œä½†å®ƒä¸åŒ…æ‹¬ç”± C æ•°å­¦åº“å®šä¹‰çš„ transcendental æ“ä½œã€‚

### è®ºå›åŠ¨å‘

[Michael Ilseman](https://twitter.com/ilseman) åˆ†äº«äº†[å…³äº Swift 5 ä¸­å­—ç¬¦ä¸² ABI çš„ä¸€äº›èƒŒæ™¯çŸ¥è¯†](https://forums.swift.org/t/piercing-the-string-veil/21700)ã€‚

> String çš„ ABI ä¸ºäº†é«˜æ€§èƒ½å¤„ç†å’Œæœªæ¥çš„çµæ´»æ€§è¿›è¡Œå­—ç¬¦ä¸²ç¼–ç ï¼Œä½¿æ ‡å‡†åº“è¿è¡Œé€Ÿåº¦æ›´å¿«ï¼Œç”Ÿæˆçš„ä»£ç æ›´å°ï¼Œæ›´çµæ´»ã€‚ä½†æ˜¯ï¼Œç°åœ¨è¿™äº›åº•å±‚çš„ API è¿˜æ²¡æœ‰æš´éœ²å‡ºæ¥ä»¥ä¾›ä½¿ç”¨ï¼Œå› ä¸ºå®ƒéšè—åœ¨ String ç±»å‹çš„èƒŒåã€‚æˆ‘ä»¬åº”è¯¥æ­å¼€ `String` ç±»å‹çš„é¢çº±å¹¶å¼€å§‹å°†å®ƒä»¬æš´éœ²ä¸ºAPIã€‚

[Michael Munday](https://forums.swift.org/u/mundaym/summary) åˆ†äº«äº†[ä¸€ä»½æ€»ç»“](https://forums.swift.org/t/fixing-enums-on-big-endian-systems/21730)å…³äºæšä¸¾ç±»å‹ `enum` çš„å†…å­˜ç»“æ„å®ç°ã€‚

[Doug Gregor](https://twitter.com/dgregor79/) èµ·è‰äº†[ä¸€ä»½è‰æ¡ˆ](https://forums.swift.org/t/pitch-key-path-member-lookup/21579)å…³äº Key Path çš„æˆå‘˜æŸ¥æ‰¾åŠŸèƒ½ã€‚

> åŠ¨æ€æˆå‘˜æŸ¥æ‰¾å…è®¸ç±»å‹ä¸ºä»»æ„æˆå‘˜åç§°é€‰æ‹©æ‰©å±•æˆå‘˜æŸ¥æ‰¾ï¼ˆ**ç‚¹**è¯­æ³•ï¼‰ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºè¿è¡Œæ—¶è§£æçš„å­—ç¬¦ä¸²ã€‚åŠ¨æ€æˆå‘˜æŸ¥æ‰¾ä¸åŠ¨æ€è¯­è¨€ä¹‹é—´å¯ä»¥äº’ç›¸æ“ä½œï¼Œå…¶ä¸­ç‰¹å®šå®ä¾‹çš„æˆå‘˜åªèƒ½åœ¨è¿è¡Œæ—¶ç¡®å®š...ä½†ä¸èƒ½æ›´æ—©ã€‚å› æ­¤ï¼ŒåŠ¨æ€æˆå‘˜æŸ¥æ‰¾å€¾å‘äºä½¿ç”¨å›´ç»•å¤–éƒ¨è¯­è¨€å¯¹è±¡çš„ç±»å‹æ“¦é™¤å°è£…ï¼ˆä¾‹å¦‚ï¼Œå¯¹äºä»»æ„ Python å¯¹è±¡çš„ `PyVal`ï¼‰ï¼Œå®ƒä»¬å¹¶ä¸æä¾›è¶³å¤Ÿçš„é™æ€ç±»å‹ä¿¡æ¯ã€‚ 
>
> [æˆ‘ä»¬å»ºè®®]å¼•å…¥ä¸€ä¸ªæ–°å±æ€§ `@keyPathMemberLookup`ï¼Œå®ƒå¯ä»¥æ”¾åœ¨ä¸€ä¸ªç±»å‹çš„å®šä¹‰ä¸Šã€‚å¯¹äºè¿™æ ·çš„ç±»å‹ï¼Œè®¿é—®æˆå‘˜çš„**ç‚¹**è¯­æ³•å°†è¢«é‡å†™ä¸ºä½¿ç”¨ç‰¹æ®Šçš„ä¸‹æ ‡ï¼Œå…¶å‚æ•°æ˜¯æè¿°æˆå‘˜çš„å…³é”®è·¯å¾„ã€‚

[Manolo van Ee](https://forums.swift.org/u/orobio/summary) åˆ†äº«äº†ä¸€ç¯‡å…³äº Opaque Result ç±»å‹çš„[æ–‡ç« ](https://forums.swift.org/t/reverse-generics-and-opaque-result-types/21608)ã€‚

> è¿‡å»ä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä¸€ç›´åœ¨å°è¯•ç†è§£ [SE-0244](https://forums.swift.org/t/se-0244-opaque-result-types/21252)ï¼š*Opaque Result Types*ï¼Œæœ€è¿‘æˆ‘å‘ç°äº†ä¸€äº›ä¸œè¥¿èƒ½å¸®åŠ©æˆ‘æ›´å¥½åœ°ç†è§£è¿™ä¸ªææ¡ˆã€‚æˆ‘æ³¨æ„åˆ°å¾ˆå¤šäººä¹Ÿå¯¹è¿™ä¸ªææ¡ˆæ„Ÿåˆ°å›°æƒ‘ï¼Œæ‰€ä»¥æˆ‘æƒ³å†™ä¸‹è¿™ç¯‡æ–‡ç« å¸®åŠ©ä»–äººæ›´å¥½åœ°ç†è§£ã€‚
>
> æˆ‘è¿˜å°è¯•å°†ä¸é€æ˜çš„ç»“æœç±»å‹æˆ–è€…å®ƒèƒŒåçš„åŸºç¡€æœºåˆ¶é‡æ–°å‘½åä¸ºæˆ‘ç§°ä¹‹ä¸º "åå‘æ³›å‹" çš„ä¸œè¥¿ã€‚æˆ‘è®¤ä¸ºä»ç•¥å¾®ä¸åŒçš„è§’åº¦æ¥çœ‹è¿™ä¸€åˆ‡èƒ½æ›´å¥½åœ°ç†è§£æ‰€æ¶‰åŠçš„æ¦‚å¿µã€‚

[Tom Doron](https://twitter.com/TomerDoron) åˆ†äº«ä¸€ä¸ªå…³äº Swift æœåŠ¡å™¨ç«¯ API çš„[ææ¡ˆ](https://forums.swift.org/t/feedback-server-metrics-api/21353)ã€‚

> å‡ ä¹æ‰€æœ‰ç”Ÿäº§æœåŠ¡å™¨è½¯ä»¶éƒ½éœ€è¦å‘å‡ºå¯è§‚å¯Ÿæ€§çš„åº¦é‡ä¿¡æ¯ã€‚ SSWG æ—¨åœ¨æä¾›å¯åœ¨æ•´ä¸ª Swift Server ç”Ÿæ€ç³»ç»Ÿä¸­å…±äº«çš„è½¯ä»¶åŒ…ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€å®šç¨‹åº¦çš„æ ‡å‡†åŒ–ã€‚ç”±äºå„æ–¹é¢éƒ½ä¸å¤ªå¯èƒ½å°±ä¸€ä¸ªå®Œæ•´çš„æŒ‡æ ‡å®æ–½è¾¾æˆä¸€è‡´ï¼Œå› æ­¤è¯¥ææ¡ˆæ­£åœ¨å°è¯•å»ºç«‹ä¸€ä¸ªå¯ç”±å„ç§æŒ‡æ ‡åç«¯å®ç°çš„æŒ‡æ ‡ APIï¼Œç„¶åå°†æŒ‡æ ‡æ•°æ®å‘å¸ƒåˆ°åç«¯ï¼Œå¦‚ prometheusï¼Œgraphiteï¼Œé€šè¿‡ statsd å‘å¸ƒï¼Œå†™å…¥ç£ç›˜ç­‰å¸¸è§çš„æŒ‡æ ‡ã€‚
>
> å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬åº”è¯¥å¯¹ API è¿›è¡Œæ ‡å‡†åŒ–ï¼Œå¦‚æœæˆæ•ˆå¾ˆå¥½ï¼Œåº”ç”¨ç¨‹åºæ‰€æœ‰è€…å¯ä»¥ä½¿ç”¨ä¸€è‡´çš„åº¦é‡æ ‡å‡†æ¥æ”¶é›†è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä»ä¸­é€‰æ‹©å¯¹åº”çš„åº“ã€‚

[Vinicius Vendramini](https://twitter.com/vvendra) èµ·è‰äº†[ä¸€ä»½ææ¡ˆ](https://forums.swift.org/t/pitch-introduce-custom-attributes/21335)å¼•å…¥è‡ªå®šä¹‰ attributesã€‚

> Swift ç›®å‰æ”¯æŒä½¿ç”¨å±æ€§æ ‡è®°å£°æ˜ï¼Œä¾‹å¦‚ `@objc` å’Œ `@deprecated`ã€‚ç¼–è¯‘å™¨ä½¿ç”¨è¿™äº›å±æ€§æ¥æ›´æ”¹å®ƒè§£é‡Šç›¸åº”ä»£ç çš„æ–¹å¼ã€‚ä½†è¿™äº›åŠŸèƒ½ç›®å‰ä»ä¸èƒ½æ»¡è¶³é¡¹ç›®æˆ–åº“çš„ä½¿ç”¨ã€‚è¯¥ææ¡ˆæ—¨åœ¨æ”¹è¿›è¿™ä¸ªåœ°æ–¹ã€‚

[Dan Zheng](https://github.com/dan-zheng) å’Œ [Richard Wei](https://twitter.com/rxwei) èµ·è‰äº†[ä¸€ä»½è‰æ¡ˆ](https://forums.swift.org/t/pitch-introduce-static-callables/21732)è®¡åˆ’å¼•å…¥ [callables å¯¹è±¡](https://en.wikipedia.org/wiki/Callable_object)ã€‚

> è¯¥ææ¡ˆå‘ Swift å¼•å…¥äº† [callables](https://en.wikipedia.org/wiki/Callable_object)ã€‚å€¼ç±»å‹å¯ä»¥åˆ©ç”¨è¿™ç§è¯­æ³•ç³–ï¼Œè®©å®ƒä»¬åœ¨è¢«è°ƒç”¨æ—¶æ›´åƒå‡½æ•°è°ƒç”¨ã€‚
> ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å»ºè®®å¼•å…¥ä¸€ä¸ªå¸¦æœ‰å…³é”®å­— `call` çš„æ–°å£°æ˜è¯­æ³•ï¼š

{% highlight swift %}
struct Adder {
    var base: Int
    call(_ x: Int) -> Int {
        return base + x
    }
}
{% endhighlight %}

> Values that have a call member can be applied like a function, forwarding arguments to the call member.

{% highlight swift %}
let add3 = Adder(base: 3)
add3(10) // => 13
{% endhighlight %}

### å°¾å£°

ä½ ä¹Ÿæ›¾ç»å¼•èµ·è¿‡[å°å°çš„å†…å­˜æ³„æ¼](https://twitter.com/oskargroth/status/1106693954991476745)å—ï¼ŸğŸš°
